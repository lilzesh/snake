!function(){"use strict";const t={ArrowLeft:"x",ArrowRight:"x",ArrowUp:"y",ArrowDown:"y"},e={ArrowLeft:-1,ArrowRight:1,ArrowUp:-1,ArrowDown:1},s={x:"width",y:"height"};var i=new class{constructor(t){this.canvas=t.root,this.ctx=this.canvas.getContext("2d"),this.bounds=this.canvas.getBoundingClientRect(),this.size=10,this.segments=[{x:this.coord("x"),y:this.coord("y")}],this.axis=void 0,this.dir=void 0,this.target=this.get_target_loc(),window.addEventListener("keydown",this.key.bind(this))}set add(t){this.segments.push(t)}set new_target(t){this.target=t}key(s){t[s.code]!==this.axis&&(this.axis=t[s.code],this.dir=e[s.code])}coord(t){let e="x"===t?this.bounds.width/this.size:this.bounds.height/this.size;return e-=this.size,Math.floor(Math.random()*e)*this.size}out_of_bounds(){let t=this.segments[0],e=!0;return e=-1===this.dir?t[this.axis]<0:t[this.axis]>this.canvas[s[this.axis]],e}get_target_loc(){const t={x:this.coord("x"),y:this.coord("y")};return this.in_segments(t,0)?this.get_target_loc():t}in_segments(t,e=0){let s=!1;for(let i=e;i<this.segments.length;i++){const e=this.segments[i].x===t.x,r=this.segments[i].y===t.y;if(e&&r){s=!0;break}}return s}draw_snake(){for(let t=0;t<this.segments.length;t++)this.ctx.fillStyle="#a9b1d6",this.ctx.fillRect(this.segments[t].x,this.segments[t].y,this.size,this.size)}draw_target(){this.ctx.fillStyle="#9d7cd8",this.ctx.fillRect(this.target.x,this.target.y,this.size,this.size)}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}reset(){this.segments=[{x:this.coord("x"),y:this.coord("y")}],this.axis=void 0,this.dir=void 0,this.target=this.get_target_loc()}}({root:root});(()=>{let t,e,s,r,n,o;function h(c){if(t)return i.clear(),message.textContent="game over",void restart.removeAttribute("hidden");window.requestAnimationFrame(h),r=s+e,n=0,c>r&&(o=c-s,n=Math.floor(o/e)),function(t){for(let i=0;i<t;i++)s+=e,a()}(n),i.draw_snake(),i.draw_target()}function a(e){const s=i.segments[0],r=i.dir*i.size;if(i.axis&&i.dir){i.clear(),i.segments.unshift({x:"x"===i.axis?s.x+r:s.x,y:"y"===i.axis?s.y+r:s.y}),i.segments.pop();const e=i.out_of_bounds(),n=i.in_segments(i.segments[0],1);(e||n)&&(t=!0)}s.x===i.target.x&&s.y===i.target.y&&(i.segments.push(i.target),score.textContent=i.segments.length,i.new_target=i.get_target_loc())}function c(){t=!1,s=performance.now(),e=50,score.textContent=1,message.textContent="arrow to move",i.reset()}restart.addEventListener("click",()=>{restart.setAttribute("hidden",!0),c(),h(performance.now())}),c(),h(performance.now())})()}();
